services:

  api:
    image: langgenius/dify-api:main
    environment:
      # WARNING: The following two environment variables may violate license terms if misused.
      #          They are enabled here for automated testing purposes only.
      ALLOW_REGISTER: "true"
      ALLOW_CREATE_WORKSPACE: "true"

  worker:
    image: langgenius/dify-api:main

  worker_beat:
    image: langgenius/dify-api:main

  web:
    image: langgenius/dify-web:main

  sandbox:
    image: langgenius/dify-sandbox:main

  plugin_daemon:
    image: langgenius/dify-plugin-daemon:main-local

  phoenix:
    image: arizephoenix/phoenix:version-11
    ports:
      - 6006:6006
    environment:
      PHOENIX_WORKING_DIR: /mnt/data
      PHOENIX_SECRET: ${PHOENIX_SECRET:-}
      PHOENIX_ADMIN_SECRET: ${PHOENIX_ADMIN_SECRET:-}
    volumes:
      - phoenix_data:/mnt/data

volumes:
  phoenix_data:
    driver: local
